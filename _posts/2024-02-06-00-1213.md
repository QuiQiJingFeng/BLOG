---
layout: post
title:  "低帧率下多次点击问题"
image: ''
date:   2024-02-06 10:48:35
tags:
- Cocos
description: ''
categories: 
- Cocos
---

因为点击是个即时触发的回调,而回调里面的逻辑却不是,比如回调里有个action或者动画要执行。
这就会造成一个问题:
在下一帧还没到来时,触发多次点击或者多个按钮的点击。

对于多次点击,只需要在回调方法里添加避免多次点击的处理就好。
但是对于多个按钮的点击就不太行了。

比如一个按钮A点击后执行一个1秒的动作,之后对结点P做隐藏处理。
另一个按钮B点击后立刻对结点A做删除处理。
此时就会产生来自不同点击流程的冲突。
因为按钮A执行的是一个带有时间的过程,而按钮B执行的是个立即的过程(或者时间更短的过程也类似)
除非在A点击的时候执行全屏点击屏蔽,否则就会出现问题。
比如点击A课程的时候同时也可以点击B课程。

但是对于一些特殊情况则无法全屏点击,
比如点击一个按钮弹出一个框,那么弹框显示之后则必然要放开点击的。
先点击按钮B等待时间2秒弹出弹窗  再点击按钮A等待1秒切换场景。
那么此时在按钮B的弹窗出现过程中就需要全屏屏蔽点击。

但是假如按钮B点击之后有个按钮弹跳的动画,按钮A也有个弹跳动画,并且按钮A的弹跳动画时间要小于按钮B。
此时点击按钮B,然后立刻点击按钮A,那么仍然会出现流程冲突的情况。
解决的办法仍然是全屏锁。

除非是任何点击都进行全屏锁的情况,否则涉及到逻辑细节就太多了(太依赖开发者的能力,万一忘了也是问题),开发效率也会降低,也更容易出现发生错误的时候直接被全屏锁住了的情况。

或者更简单一点的处理是,遇到需要删除UI的情况下,对全屏加锁。

另外为了避免全屏锁由于bug或者其他原因无法销毁,可以做个安全的延迟时间进行销毁。

另外尽量不要使用schedule，使用action的延迟做替换更好。
因为当发生删除对象的时候,schedule仍然会执行回调